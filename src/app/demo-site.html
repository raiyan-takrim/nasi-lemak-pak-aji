<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nasi Lemak Pak Aji - Malaysian Heritage</title>

    <!-- React & ReactDOM -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Theme Configuration -->
    <style>
      :root {
        --radius: 0.65rem;
        /* Base Light Theme */
        --background: oklch(0.985 0.002 169); /* Slightly tinted white */
        --foreground: oklch(0.14 0.01 169);

        --card: oklch(1 0 0);
        --card-foreground: oklch(0.14 0.01 169);

        --popover: oklch(1 0 0);
        --popover-foreground: oklch(0.14 0.01 169);

        /* User Requested Primary */
        --primary: oklch(0.38 0.07 169);
        --primary-foreground: oklch(0.98 0 0);

        --secondary: oklch(0.93 0.03 169);
        --secondary-foreground: oklch(0.38 0.07 169);

        --muted: oklch(0.96 0.01 169);
        --muted-foreground: oklch(0.55 0.02 169);

        --accent: oklch(0.94 0.03 169);
        --accent-foreground: oklch(0.38 0.07 169);

        --destructive: oklch(0.577 0.245 27.325);
        --destructive-foreground: oklch(0.98 0 0);

        --border: oklch(0.85 0.02 169);
        --input: oklch(0.92 0.01 169);
        --ring: oklch(0.38 0.07 169);
      }

      .dark {
        --background: oklch(0.12 0.02 169);
        --foreground: oklch(0.98 0.01 169);

        --card: oklch(0.16 0.03 169);
        --card-foreground: oklch(0.98 0.01 169);

        --popover: oklch(0.15 0.02 169);
        --popover-foreground: oklch(0.98 0.01 169);

        --primary: oklch(0.45 0.09 169); /* Slightly brighter for dark mode */
        --primary-foreground: oklch(0.98 0 0);

        --secondary: oklch(0.22 0.04 169);
        --secondary-foreground: oklch(0.98 0 0);

        --muted: oklch(0.2 0.03 169);
        --muted-foreground: oklch(0.7 0.02 169);

        --accent: oklch(0.22 0.04 169);
        --accent-foreground: oklch(0.98 0 0);

        --destructive: oklch(0.45 0.15 25);
        --destructive-foreground: oklch(0.98 0 0);

        --border: oklch(0.25 0.03 169);
        --input: oklch(0.25 0.03 169);
        --ring: oklch(0.38 0.07 169);
      }

      body {
        font-family: "Plus Jakarta Sans", sans-serif;
        background-color: var(--background);
        color: var(--foreground);
        transition: background-color 0.3s, color 0.3s;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: "Playfair Display", serif;
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background-color: var(--border);
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background-color: var(--primary);
      }

      /* Chat Widget Animations */
      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .chat-slide-in {
        animation: slideIn 0.3s ease-out forwards;
      }
    </style>

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              border: "var(--border)",
              input: "var(--input)",
              ring: "var(--ring)",
              background: "var(--background)",
              foreground: "var(--foreground)",
              primary: {
                DEFAULT: "var(--primary)",
                foreground: "var(--primary-foreground)",
              },
              secondary: {
                DEFAULT: "var(--secondary)",
                foreground: "var(--secondary-foreground)",
              },
              destructive: {
                DEFAULT: "var(--destructive)",
                foreground: "var(--destructive-foreground)",
              },
              muted: {
                DEFAULT: "var(--muted)",
                foreground: "var(--muted-foreground)",
              },
              accent: {
                DEFAULT: "var(--accent)",
                foreground: "var(--accent-foreground)",
              },
              popover: {
                DEFAULT: "var(--popover)",
                foreground: "var(--popover-foreground)",
              },
              card: {
                DEFAULT: "var(--card)",
                foreground: "var(--card-foreground)",
              },
            },
            borderRadius: {
              lg: "var(--radius)",
              md: "calc(var(--radius) - 2px)",
              sm: "calc(var(--radius) - 4px)",
            },
          },
        },
      };
    </script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef } = React;
      const apiKey = ""; // System provides this at runtime

      // --- Data: The Menu ---
      const menuItems = [
        {
          id: 1,
          name: "Nasi Lemak Bunga Raya (Classic)",
          price: "RM 3.50",
          description:
            "The original taste of heritage. Fragrant coconut rice served with our signature sweet-spicy sambal, crunchy anchovies, peanuts, cucumber, and a hard-boiled egg.",
          history:
            "This dish represents the unity of Malaysia. The 'Nasi Lemak Biasa' was traditionally a breakfast meal for farmers, providing high energy for the day. Wrapped in banana leaves to enhance aroma, it is the canvas upon which all other Nasi Lemak variations are painted.",
          sub_menu: [
            { name: "Extra Sambal", price: "RM 0.50" },
            { name: "Telur Mata (Fried Egg)", price: "RM 1.50" },
          ],
          image:
            "https://images.unsplash.com/photo-1574488390691-2dc2d141e6c1?q=80&w=1000&auto=format&fit=crop",
          tag: "Best Seller",
        },
        {
          id: 2,
          name: "Nasi Lemak Ayam Berempah",
          price: "RM 9.50",
          description:
            "Served with a whole leg of chicken marinated in 12 different spices including lemongrass, ginger, and turmeric, then deep-fried to golden perfection.",
          history:
            "Ayam Goreng Berempah (Spiced Fried Chicken) became a popular pairing in the late 80s as Nasi Lemak transitioned from a light breakfast to a hearty lunch or dinner option. The aromatic herbs in the chicken complement the santan (coconut milk) rice perfectly.",
          sub_menu: [
            { name: "Ayam Extra Piece", price: "RM 5.00" },
            { name: "Begedil (Potato Patty)", price: "RM 1.50" },
          ],
          image:
            "https://images.unsplash.com/photo-1626202167439-d8e2008f5d02?q=80&w=1000&auto=format&fit=crop",
          tag: "Chef's Kiss",
        },
        {
          id: 3,
          name: "Nasi Lemak Sambal Sotong",
          price: "RM 8.00",
          description:
            "Tender squid rings slow-cooked in a deep, rich dried chili paste until soft and flavorful.",
          history:
            "Originating from the coastal Malay communities, preserving squid in spicy sambal allowed fishermen to enjoy their catch with rice. Our recipe uses 'Sotong Kering' (dried squid) which is rehydrated for 24 hours to achieve that distinct chewy yet tender texture adored by locals.",
          sub_menu: [
            { name: "Extra Sotong", price: "RM 4.00" },
            { name: "Teh Tarik Ikat Tepi", price: "RM 2.50" },
          ],
          image:
            "https://images.unsplash.com/photo-1628045934662-7561a351792d?q=80&w=1000&auto=format&fit=crop",
          tag: "Spicy",
        },
        {
          id: 4,
          name: "Nasi Lemak Rendang Daging",
          price: "RM 10.50",
          description:
            "Beef cubes simmered for hours in coconut milk and 'kerisik' (toasted coconut paste) until nearly dry and incredibly tender.",
          history:
            "Rendang is a Minangkabau dish that found a permanent home in Malaysian cuisine. Traditionally reserved for festivities like Hari Raya, we bring this celebration to your plate daily. The combination of rich, nutty Rendang gravy with Nasi Lemak is a testament to cultural integration.",
          sub_menu: [
            { name: "Extra Kuah Rendang", price: "RM 1.00" },
            { name: "Paru Goreng (Beef Lungs)", price: "RM 3.00" },
          ],
          image:
            "https://images.unsplash.com/photo-1601925087368-24b898950666?q=80&w=1000&auto=format&fit=crop",
          tag: "Heritage",
        },
      ];

      // --- Inline SVG Icons ---
      const IconWrapper = ({ children, className }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          {children}
        </svg>
      );

      const Icons = {
        Utensils: () => (
          <IconWrapper className="w-5 h-5">
            <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2" />
            <path d="M7 2v20" />
            <path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" />
          </IconWrapper>
        ),
        Info: () => (
          <IconWrapper className="w-5 h-5">
            <circle cx="12" cy="12" r="10" />
            <path d="M12 16v-4" />
            <path d="M12 8h.01" />
          </IconWrapper>
        ),
        X: () => (
          <IconWrapper className="w-6 h-6">
            <path d="M18 6 6 18" />
            <path d="m6 6 12 12" />
          </IconWrapper>
        ),
        ChevronRight: () => (
          <IconWrapper className="w-4 h-4">
            <path d="m9 18 6-6-6-6" />
          </IconWrapper>
        ),
        Moon: () => (
          <IconWrapper className="w-5 h-5">
            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
          </IconWrapper>
        ),
        Sun: () => (
          <IconWrapper className="w-5 h-5">
            <circle cx="12" cy="12" r="4" />
            <path d="M12 2v2" />
            <path d="M12 20v2" />
            <path d="m4.93 4.93 1.41 1.41" />
            <path d="m17.66 17.66 1.41 1.41" />
            <path d="M2 12h2" />
            <path d="M20 12h2" />
            <path d="m6.34 17.66-1.41-1.41" />
            <path d="m19.07 4.93-1.41 1.41" />
          </IconWrapper>
        ),
        Leaf: () => (
          <IconWrapper className="w-5 h-5">
            <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.5 2 10 0 5.5-4.5 10-10 10Z" />
            <path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12" />
          </IconWrapper>
        ),
        Sparkles: () => (
          <IconWrapper className="w-5 h-5">
            <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" />
          </IconWrapper>
        ),
        Send: () => (
          <IconWrapper className="w-5 h-5">
            <path d="m22 2-7 20-4-9-9-4Z" />
            <path d="M22 2 11 13" />
          </IconWrapper>
        ),
        MessageCircle: () => (
          <IconWrapper className="w-6 h-6">
            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5Z" />
          </IconWrapper>
        ),
      };

      // --- Gemini Integration ---
      const generateResponse = async (userPrompt) => {
        const systemInstruction = `
                You are "Pak Aji's Digital Spirit", a friendly, warm, and knowledgeable Malaysian food historian and concierge for the Nasi Lemak Pak Aji website.
                
                YOUR KNOWLEDGE BASE:
                ${JSON.stringify(menuItems)}

                YOUR ROLE:
                1. Act as a Heritage Guide: Explain the history of Nasi Lemak, ingredients (santan, pandan, anchovies), and Malaysian food culture.
                2. Act as a Waiter: Recommend dishes from the specific menu provided above based on the user's mood or preference (e.g., "spicy", "hungry", "adventurous").
                
                TONE:
                - Warm, welcoming, and polite.
                - Use a sprinkle of Malaysian English (Manglish) like "lah", "sedap", "jom" naturally, but keep it understandable for everyone.
                - Be helpful and concise (keep answers under 80 words unless asked for a story).

                CONSTRAINTS:
                - ONLY recommend items from the provided menu list.
                - If asked about dishes not on the menu, politely say Pak Aji doesn't serve that yet but suggest the closest alternative.
            `;

        try {
          const response = await fetch(
            `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                contents: [{ parts: [{ text: userPrompt }] }],
                systemInstruction: { parts: [{ text: systemInstruction }] },
              }),
            }
          );

          if (!response.ok) throw new Error("API Error");

          const data = await response.json();
          return data.candidates[0].content.parts[0].text;
        } catch (error) {
          console.error("Gemini Error:", error);
          return "Maaf ya (Sorry), the kitchen is a bit busy! My spirit is disconnecting. Please try again later.";
        }
      };

      // --- Components ---

      const Nav = ({ darkMode, toggleTheme }) => (
        <nav className="fixed w-full z-50 bg-background/80 backdrop-blur-md border-b border-border transition-colors duration-300">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="flex justify-between items-center h-16">
              <div className="flex items-center space-x-2">
                <div className="w-8 h-8 bg-primary rounded-lg flex items-center justify-center text-primary-foreground">
                  <Icons.Utensils />
                </div>
                <span className="font-serif font-bold text-xl tracking-tight text-foreground">
                  Pak Aji
                </span>
              </div>
              <div className="flex items-center space-x-6">
                <a
                  href="#menu"
                  className="hidden md:block text-sm font-medium text-muted-foreground hover:text-primary transition-colors"
                >
                  Menu
                </a>
                <a
                  href="#heritage"
                  className="hidden md:block text-sm font-medium text-muted-foreground hover:text-primary transition-colors"
                >
                  Our Heritage
                </a>
                <button
                  onClick={toggleTheme}
                  className="p-2 rounded-full hover:bg-accent text-foreground transition-colors"
                >
                  {darkMode ? <Icons.Sun /> : <Icons.Moon />}
                </button>
              </div>
            </div>
          </div>
        </nav>
      );

      const Hero = () => (
        <div className="relative pt-24 pb-16 md:pt-32 md:pb-24 overflow-hidden">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div className="text-center max-w-3xl mx-auto">
              <div className="inline-flex items-center px-3 py-1 rounded-full bg-secondary text-secondary-foreground text-xs font-semibold mb-6 tracking-wide uppercase">
                Thinking & Communication Skills Project
              </div>
              <h1 className="text-5xl md:text-7xl font-bold text-foreground mb-6 leading-tight">
                The Taste of{" "}
                <span className="text-primary italic">Malaysian</span> Heritage
              </h1>
              <p className="text-lg md:text-xl text-muted-foreground mb-10 leading-relaxed">
                Experience the authenticity of Nasi Lemak Pak Aji. Preserving
                tradition, one plate at a time. A culinary journey through our
                national identity.
              </p>
              <div className="flex flex-col sm:flex-row items-center justify-center gap-4">
                <a
                  href="#menu"
                  className="px-8 py-3 bg-primary text-primary-foreground font-semibold rounded-lg hover:bg-primary/90 transition-all shadow-lg shadow-primary/25 w-full sm:w-auto text-center"
                >
                  View Menu
                </a>
                <a
                  href="#heritage"
                  className="px-8 py-3 bg-white dark:bg-card text-foreground font-semibold rounded-lg border border-border hover:bg-accent transition-all w-full sm:w-auto text-center"
                >
                  Read History
                </a>
              </div>
            </div>
          </div>

          {/* Abstract Background Decoration */}
          <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-primary/10 rounded-full blur-[120px] -z-10"></div>
        </div>
      );

      const HeritageSection = () => (
        <section id="heritage" className="py-16 bg-secondary/30">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="grid md:grid-cols-2 gap-12 items-center">
              <div className="space-y-6">
                <h2 className="text-3xl md:text-4xl font-bold text-foreground">
                  More Than Just Breakfast
                </h2>
                <p className="text-muted-foreground leading-relaxed">
                  This digital menu is part of our "Thinking and Communication
                  Skills" coursework. We chose Nasi Lemak Pak Aji because food
                  is the strongest language in Malaysia. It bridges gaps between
                  cultures, ages, and backgrounds.
                </p>
                <p className="text-muted-foreground leading-relaxed">
                  Nasi Lemak is considered the national dish of Malaysia. The
                  name literally means "oily or fatty rice," but in this
                  context, it means "rich" or "creamy". The process of soaking
                  rice in coconut milk and steaming it with pandan leaves
                  creates a fragrance that is instantly recognizable to any
                  Malaysian.
                </p>
                <div className="flex items-center space-x-4 pt-4">
                  <div className="flex items-center space-x-2 text-primary font-medium">
                    <Icons.Leaf />
                    <span>Pandan Infused</span>
                  </div>
                  <div className="w-1 h-1 bg-muted-foreground rounded-full"></div>
                  <div className="flex items-center space-x-2 text-primary font-medium">
                    <span className="text-xl">üå∂Ô∏è</span>
                    <span>Authentic Sambal</span>
                  </div>
                </div>
              </div>
              <div className="relative h-80 md:h-[500px] rounded-2xl overflow-hidden shadow-2xl ring-1 ring-border">
                <img
                  src="https://images.unsplash.com/photo-1635515242784-2f22b8214db2?q=80&w=1000&auto=format&fit=crop"
                  alt="Malaysian Heritage Food"
                  className="w-full h-full object-cover hover:scale-105 transition-transform duration-700"
                />
                <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-8">
                  <p className="text-white font-serif italic text-lg">
                    "Where culture meets cuisine."
                  </p>
                </div>
              </div>
            </div>
          </div>
        </section>
      );

      const MenuModal = ({ item, onClose }) => {
        if (!item) return null;

        return (
          <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200">
            <div className="bg-card w-full max-w-4xl rounded-xl shadow-2xl overflow-hidden flex flex-col md:flex-row max-h-[90vh]">
              {/* Image Side */}
              <div className="w-full md:w-1/2 h-48 md:h-auto relative">
                <img
                  src={item.image}
                  alt={item.name}
                  className="w-full h-full object-cover"
                />
                <div className="absolute top-4 left-4 bg-white/90 dark:bg-black/80 backdrop-blur text-foreground px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider">
                  Origin Story
                </div>
              </div>

              {/* Content Side */}
              <div className="w-full md:w-1/2 p-6 md:p-8 flex flex-col overflow-y-auto">
                <div className="flex justify-between items-start mb-4">
                  <div>
                    <h3 className="text-2xl font-bold font-serif text-foreground">
                      {item.name}
                    </h3>
                    <p className="text-xl text-primary font-bold mt-1">
                      {item.price}
                    </p>
                  </div>
                  <button
                    onClick={onClose}
                    className="p-2 hover:bg-secondary rounded-full text-muted-foreground hover:text-foreground transition-colors"
                  >
                    <Icons.X />
                  </button>
                </div>

                <div className="prose prose-sm dark:prose-invert mb-6">
                  <p className="text-muted-foreground">{item.description}</p>
                </div>

                <div className="bg-secondary/50 rounded-lg p-5 mb-6 border border-border">
                  <h4 className="text-sm font-bold uppercase tracking-wider text-primary mb-2 flex items-center gap-2">
                    <Icons.Info /> Historical Context
                  </h4>
                  <p className="text-sm text-foreground/80 leading-relaxed italic">
                    "{item.history}"
                  </p>
                </div>

                <div className="mt-auto">
                  <h4 className="font-bold text-foreground mb-3">
                    Add-on Suggestions (Sub Menu)
                  </h4>
                  <ul className="space-y-2">
                    {item.sub_menu.map((sub, idx) => (
                      <li
                        key={idx}
                        className="flex justify-between items-center text-sm p-3 rounded-md bg-background border border-border"
                      >
                        <span className="text-foreground font-medium">
                          {sub.name}
                        </span>
                        <span className="text-muted-foreground">
                          {sub.price}
                        </span>
                      </li>
                    ))}
                  </ul>
                </div>
              </div>
            </div>
          </div>
        );
      };

      const MenuSection = ({ onSelectItem }) => (
        <section
          id="menu"
          className="py-20 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"
        >
          <div className="text-center mb-12">
            <span className="text-primary font-semibold tracking-wider uppercase text-sm">
              Authentic Selection
            </span>
            <h2 className="text-4xl font-bold font-serif text-foreground mt-2">
              The Pak Aji Menu
            </h2>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            {menuItems.map((item) => (
              <div
                key={item.id}
                onClick={() => onSelectItem(item)}
                className="group bg-card rounded-xl border border-border overflow-hidden hover:shadow-xl hover:shadow-primary/10 transition-all duration-300 cursor-pointer flex flex-col"
              >
                <div className="relative h-48 overflow-hidden">
                  <img
                    src={item.image}
                    alt={item.name}
                    className="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500"
                  />
                  <div className="absolute inset-0 bg-black/20 group-hover:bg-black/0 transition-colors duration-300"></div>
                  {item.tag && (
                    <span className="absolute top-3 right-3 bg-primary text-primary-foreground text-xs font-bold px-2 py-1 rounded">
                      {item.tag}
                    </span>
                  )}
                </div>
                <div className="p-5 flex-1 flex flex-col">
                  <h3 className="font-bold text-lg text-foreground mb-2 line-clamp-1">
                    {item.name}
                  </h3>
                  <p className="text-muted-foreground text-sm mb-4 line-clamp-2">
                    {item.description}
                  </p>
                  <div className="mt-auto flex justify-between items-center">
                    <span className="text-lg font-bold text-primary">
                      {item.price}
                    </span>
                    <span className="text-xs text-muted-foreground group-hover:text-primary transition-colors flex items-center">
                      View History <Icons.ChevronRight />
                    </span>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </section>
      );

      // --- Chat Widget Component ---
      const ChatWidget = () => {
        const [isOpen, setIsOpen] = useState(false);
        const [messages, setMessages] = useState([
          {
            sender: "bot",
            text: "Assalamualaikum! I am Pak Aji's Digital Spirit. Want to know about our history or need a food recommendation? ‚ú®",
          },
        ]);
        const [inputValue, setInputValue] = useState("");
        const [isLoading, setIsLoading] = useState(false);
        const messagesEndRef = useRef(null);

        const scrollToBottom = () => {
          messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
        };

        useEffect(() => {
          scrollToBottom();
        }, [messages, isOpen]);

        const handleSend = async (text = inputValue) => {
          if (!text.trim()) return;

          const userMessage = { sender: "user", text: text };
          setMessages((prev) => [...prev, userMessage]);
          setInputValue("");
          setIsLoading(true);

          // Quick delay to feel natural
          setTimeout(async () => {
            const replyText = await generateResponse(text);
            const botMessage = { sender: "bot", text: replyText };
            setMessages((prev) => [...prev, botMessage]);
            setIsLoading(false);
          }, 500);
        };

        return (
          <div className="fixed bottom-6 right-6 z-50 font-sans">
            {/* Chat Window */}
            {isOpen && (
              <div className="absolute bottom-16 right-0 w-[350px] sm:w-[380px] h-[500px] bg-card border border-border rounded-xl shadow-2xl flex flex-col overflow-hidden chat-slide-in">
                {/* Header */}
                <div className="bg-primary p-4 flex justify-between items-center text-primary-foreground">
                  <div className="flex items-center gap-2">
                    <div className="p-1 bg-white/20 rounded-full">
                      <Icons.Sparkles />
                    </div>
                    <span className="font-bold">Pak Aji's Heritage Bot</span>
                  </div>
                  <button
                    onClick={() => setIsOpen(false)}
                    className="hover:bg-white/20 p-1 rounded-full transition-colors"
                  >
                    <Icons.X />
                  </button>
                </div>

                {/* Messages Area */}
                <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-secondary/20">
                  {messages.map((msg, idx) => (
                    <div
                      key={idx}
                      className={`flex ${
                        msg.sender === "user" ? "justify-end" : "justify-start"
                      }`}
                    >
                      <div
                        className={`max-w-[80%] rounded-2xl px-4 py-3 text-sm leading-relaxed ${
                          msg.sender === "user"
                            ? "bg-primary text-primary-foreground rounded-br-none"
                            : "bg-card border border-border text-foreground rounded-bl-none shadow-sm"
                        }`}
                      >
                        {msg.text}
                      </div>
                    </div>
                  ))}
                  {isLoading && (
                    <div className="flex justify-start">
                      <div className="bg-card border border-border px-4 py-3 rounded-2xl rounded-bl-none shadow-sm flex items-center gap-2">
                        <div className="w-2 h-2 bg-primary/60 rounded-full animate-bounce"></div>
                        <div className="w-2 h-2 bg-primary/60 rounded-full animate-bounce delay-75"></div>
                        <div className="w-2 h-2 bg-primary/60 rounded-full animate-bounce delay-150"></div>
                      </div>
                    </div>
                  )}
                  <div ref={messagesEndRef} />
                </div>

                {/* Quick Prompts */}
                {messages.length === 1 && (
                  <div className="px-4 pb-2 flex gap-2 overflow-x-auto no-scrollbar">
                    <button
                      onClick={() => handleSend("What is Nasi Lemak?")}
                      className="whitespace-nowrap px-3 py-1.5 bg-secondary text-xs font-medium text-secondary-foreground rounded-full border border-border hover:bg-primary hover:text-primary-foreground transition-colors"
                    >
                      History of Nasi Lemak
                    </button>
                    <button
                      onClick={() => handleSend("I like spicy food!")}
                      className="whitespace-nowrap px-3 py-1.5 bg-secondary text-xs font-medium text-secondary-foreground rounded-full border border-border hover:bg-primary hover:text-primary-foreground transition-colors"
                    >
                      I like spicy ‚ú®
                    </button>
                  </div>
                )}

                {/* Input Area */}
                <div className="p-3 bg-card border-t border-border">
                  <form
                    onSubmit={(e) => {
                      e.preventDefault();
                      handleSend();
                    }}
                    className="flex gap-2"
                  >
                    <input
                      type="text"
                      value={inputValue}
                      onChange={(e) => setInputValue(e.target.value)}
                      placeholder="Ask about heritage or food..."
                      className="flex-1 bg-secondary text-foreground px-4 py-2 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-primary/50 border-transparent"
                    />
                    <button
                      type="submit"
                      disabled={isLoading}
                      className="bg-primary text-primary-foreground p-2 rounded-full hover:bg-primary/90 transition-colors disabled:opacity-50"
                    >
                      <Icons.Send />
                    </button>
                  </form>
                </div>
              </div>
            )}

            {/* FAB Toggle */}
            <button
              onClick={() => setIsOpen(!isOpen)}
              className="w-14 h-14 bg-primary text-primary-foreground rounded-full shadow-xl hover:scale-105 active:scale-95 transition-all flex items-center justify-center relative group"
            >
              {isOpen ? <Icons.X /> : <Icons.MessageCircle />}
              {!isOpen && (
                <span className="absolute -top-1 -right-1 flex h-4 w-4">
                  <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                  <span className="relative inline-flex rounded-full h-4 w-4 bg-red-500"></span>
                </span>
              )}
              {!isOpen && (
                <div className="absolute right-16 bg-foreground text-background text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap font-medium pointer-events-none">
                  Ask Pak Aji's AI ‚ú®
                </div>
              )}
            </button>
          </div>
        );
      };

      const Footer = () => (
        <footer className="bg-card border-t border-border py-12 mt-12">
          <div className="max-w-7xl mx-auto px-4 text-center">
            <div className="mb-4 flex justify-center text-primary">
              <Icons.Utensils />
            </div>
            <h3 className="font-serif text-2xl font-bold text-foreground mb-2">
              Nasi Lemak Pak Aji
            </h3>
            <p className="text-muted-foreground text-sm max-w-md mx-auto mb-8">
              Preserving the taste of home. A project for "Thinking and
              Communication Skills" course.
            </p>
            <div className="text-xs text-muted-foreground/50">
              &copy; 2025 Student Project Showcase. All rights reserved.
            </div>
          </div>
        </footer>
      );

      const App = () => {
        const [selectedItem, setSelectedItem] = useState(null);
        const [darkMode, setDarkMode] = useState(false);

        // Handle dark mode toggle
        useEffect(() => {
          if (darkMode) {
            document.documentElement.classList.add("dark");
          } else {
            document.documentElement.classList.remove("dark");
          }
        }, [darkMode]);

        return (
          <div className="min-h-screen bg-background">
            <Nav
              darkMode={darkMode}
              toggleTheme={() => setDarkMode(!darkMode)}
            />

            <main>
              <Hero />
              <HeritageSection />
              <MenuSection onSelectItem={setSelectedItem} />
            </main>

            <ChatWidget />
            <Footer />

            {selectedItem && (
              <MenuModal
                item={selectedItem}
                onClose={() => setSelectedItem(null)}
              />
            )}
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
